<!--
 * @Author: liweilong
 * @Date: 2020-10-21 10:44:47
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <!-- 通用样式 -->
  <link rel="stylesheet" href="./css/normalize.css">
  <link rel="stylesheet" href="./css/init.min.css">
  <link rel="stylesheet" href="./css/notice_detail.css">
  <link rel="stylesheet" href="./js/tool/layer/need/layer.css">
  <script src="./js/tool/flexible.js"></script>
  <script src="./js/tool/jquery.min.js"></script>
  <script src="./js/tool/layer/layer.js"></script>
  <script src="./js/tool/better-scroll.min.js"></script>
  <script src="./js/tool/art-template.js"></script>

  <script type="text/html" id="goods_detail">
    <li class="chat_li_mine_img">
      <div class="avatar_wrap">
        <div class="ava_img">
          <img src="https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=2156833431,1671740038&fm=26&gp=0.jpg"
            alt="">
          </div>
        </div>
        <div class="chat_content">
          <div class="chat_inner_content">
            <a href="goods_detail.html">
              <div class="img_wrap">
                <img src="./images/goods4.png" alt="">
              </div>
                <div class="title_wrap">
                  <p class="goods_name">大量可团购小样产品，雅诗兰黛...</p>
                  <span class="cate" style="
              background: #1a8eff;">需求</span>
                </div>
                <div class="date_wrap" style="-webkit-box-orient: vertical;">
                  5年（个月）名称：莹粹亮彩水晶唇彩4.6ml包装：无盒有密封产地：比利时进口中国组装9规格小样净含量6（g）生产日期2010保质期
              </div>
            </a>
          </div>
          </div>
      </li>
  </script>

  <!-- 自己发送的消息 -->
  <script type="text/html" id="mine_send_notice">
    <li class="chat_li_mine">
      <div class="avatar_wrap">
        <div class="ava_img">
          <img src="https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=2156833431,1671740038&fm=26&gp=0.jpg"
            alt="">
        </div>
      </div>
      <div class="chat_content">
        <div class="chat_inner_content">
          {{ content }}
        </div>
      </div>
    </li>
  </script>
  <title>聊聊</title>
</head>

<body>
  <!-- 头部 -->
  <div class="header_wrap">
    <div class="left_arrow">
      <svg t="1604625554589" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
        p-id="2873" data-spm-anchor-id="a313x.7781069.0.i3" width="35" height="35">
        <path
          d="M648 307.2H217.6l128-128c12.8-12.8 12.8-32 0-44.8-12.8-12.8-32-12.8-44.8 0L118.4 315.2c-6.4 6.4-9.6 14.4-9.6 22.4s3.2 16 9.6 22.4l180.8 180.8c12.8 12.8 32 12.8 44.8 0 12.8-12.8 12.8-32 0-44.8L219.2 371.2H648c120 0 216 96 216 216s-96 216-216 216H320c-17.6 0-32 14.4-32 32s14.4 32 32 32h328c155.2 0 280-124.8 280-280s-124.8-280-280-280z"
          fill="#ffffff" p-id="2874"></path>
      </svg>
    </div>

    <div class="head_text">千纸鹤~</div>

    <div class="more_wrap">
      <div class="svg_wrap">
        <a href="reportlist.html">
          <svg t="1603422489130" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
            p-id="5707" width="35" height="35">
            <path
              d="M512 358.555826c-12.288 0-22.26087 9.97287-22.26087 22.26087l0 268.221217c0 12.288 9.97287 22.26087 22.26087 22.26087s22.26087-9.97287 22.26087-22.26087L534.26087 380.816696C534.26087 368.528696 524.288 358.555826 512 358.555826zM512 716.176696c-12.288 0-22.26087 9.97287-22.26087 22.26087l0 44.699826c0 12.288 9.97287 22.26087 22.26087 22.26087s22.26087-9.97287 22.26087-22.26087l0-44.699826C534.26087 726.149565 524.288 716.176696 512 716.176696zM998.912 867.394783 575.688348 131.33913C559.972174 104.025043 536.754087 88.33113 512 88.33113S464.027826 104.025043 448.311652 131.33913L25.088 867.394783c-8.859826 15.426783-13.356522 30.675478-13.356522 45.345391 0 32.456348 23.908174 65.224348 77.312 65.224348l845.913043 0c53.381565 0 77.289739-32.768 77.312-65.224348C1012.268522 898.070261 1007.771826 882.821565 998.912 867.394783zM934.956522 933.420522 89.043478 933.420522c-9.861565 0-32.790261-2.025739-32.790261-20.702609 0-6.678261 2.56-14.669913 7.41287-23.129043L486.912 153.533217c15.137391-26.290087 35.06087-26.290087 50.198261 0l423.223652 736.033391c4.85287 8.45913 7.41287 16.450783 7.41287 23.129043C967.746783 931.394783 944.818087 933.420522 934.956522 933.420522z"
              p-id="5708" fill="#ffffff"></path>
          </svg>
          <span class="te_t">
            举报
          </span>
        </a>
      </div>

    </div>
    <!-- 
    <div class="list_wrap">
      <ul class="list_ul">
        <li class="list_li" style="border:none">
          
        </li>
      </ul>
    </div> -->
  </div>

  <!-- 聊天内容 -->
  <div class="chat_content_wrap wrapper">
    <ul class="chat_ul content">
      <li class="chat_li">
        <div class="avatar_wrap">
          <div class="ava_img">
            <img src="./images/touxiang.png" alt="">
          </div>
        </div>
        <div class="chat_content">
          <div class="chat_inner_content">
            你好！
          </div>
        </div>
      </li>

      <li class="chat_li_mine">
        <div class="avatar_wrap">
          <div class="ava_img">
            <img src="https://ss1.bdstatic.com/70cFvXSh_Q1YnxGkpoWK1HF6hhy/it/u=2156833431,1671740038&fm=26&gp=0.jpg"
              alt="">
          </div>
        </div>
        <div class="chat_content">
          <div class="chat_inner_content">
            你好！
          </div>
        </div>
      </li>

      <li class="chat_li">
        <div class="avatar_wrap">
          <div class="ava_img">
            <img src="./images/touxiang.png" alt="">
          </div>
        </div>
        <div class="chat_content">
          <div class="chat_inner_content">
            请问，你想了解我的需求项目吗？如果想的话，请打我这个电话，我们详细聊，电话：15888888888
          </div>
        </div>
      </li>


    </ul>
  </div>

  <!-- 底部聊天功能框 -->
  <div class="send_tab">
    <div class="input_wrap">
      <input type="text" placeholder="请输入..." class="text_input">
    </div>
    <div class="uppic">
      <svg t="1603251806982" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
        p-id="6413" width="35" height="35">
        <path
          d="M901.632 454.144h-331.776V122.368c0-14.336-11.264-25.6-25.6-25.6H479.744c-14.336 0-25.6 11.264-25.6 25.6v331.776H122.368c-14.336 0-25.6 11.264-25.6 25.6v65.024c0 14.336 11.264 25.6 25.6 25.6h331.776v331.776c0 14.336 11.264 25.6 25.6 25.6h65.024c14.336 0 25.6-11.264 25.6-25.6v-331.776h331.776c14.336 0 25.6-11.264 25.6-25.6V479.744c-0.512-14.336-11.776-25.6-26.112-25.6z"
          fill="#333333" p-id="6414"></path>
      </svg>
      <span class="text">图片</span>
    </div>
    <input hidden class="file_btn" type="file" name="file" accept="image/*">
    <div class="submit_btn">
      发送
    </div>
  </div>

</body>

</html>

<script>
  // 创建better-scroll
  let bs = BetterScroll.createBScroll('.wrapper', {
    probeType: 3,
    pullUpLoad: true,
    click: true,
    // bounce:false,
  })

  // 显示页面完成时发送商品详情
  function autoSendGoodsDeatil(data) {
    let goodsDetailHtml = template('goods_detail', data)
    $('.chat_ul').append(goodsDetailHtml)
    bs.refresh()
    let endli = returnLis()
    bs.scrollToElement(endli, 100)
  }

  // 文字输入是否显示发送按钮
  function displaySendBtn() {
    $('.text_input').on('input', function () {
      let val = $(this).val();
      if (!val.trim()) {
        $('.uppic').show()
        $('.submit_btn').hide()
      } else {
        $('.uppic').hide()
        $('.submit_btn').show()
      }
    })
  }

  // 自己发送的消息
  function sendMineNotce(data) {
    let noticeHtml = template('mine_send_notice', data)
    $('.chat_ul').append(noticeHtml)
    bs.refresh()
    let endli = returnLis()
    bs.scrollToElement(endli, 100)
  }

  // 检测.chat_ul中有多少个li标签，并返回最后一个li元素
  function returnLis() {
    let chatUl = document.querySelector('.chat_ul')
    let lis = chatUl.querySelectorAll('li')
    return lis[lis.length - 1]
  }


  /*
    已下是方法的调用
  */
  displaySendBtn()
  setTimeout(function () {
    autoSendGoodsDeatil({})
  }, 1000)

  $('.left_arrow').click(function () {
    window.history.back()
  })

  // 上传图片
  $('.uppic').click(function () {
    $('.file_btn').click();
  })

  // 监听发送按钮事件
  $('.submit_btn').click(function () {
    const content = $('.text_input').val()
    sendMineNotce({
      content
    })
  })


  // 举报出现
  // let isShow = false;
  // $('.more_wrap').click(function () {
  //   if (isShow) {
  //     $('.list_wrap').hide()
  //     $('.detail_content').css({
  //       'z-index': '1'
  //     })
  //     isShow = false
  //   } else {
  //     $('.list_wrap').show()
  //     $('.detail_content').css({
  //       'z-index': '-1'
  //     })
  //     isShow = true
  //   }
  // })

</script>